{% extends 'base.html' %}

{% block content %}
<div class="container">
	<h1 class="center-align">History</h1>

	<div class="row">
		<div class="web-history">
			{% for item in web %}
			{% if item.featured %}
			<div class="col s12 m6">
				<div class="card hoverable">
					<div class="card-content">
						<div class="card-header center-align">
							<label>{{item.title}}</label>
						</div>
						<div class="divider"></div>
						<canvas id="{{item.title}}Chart"></canvas>
					</div>
				</div>
			</div>
			{% endif %}
			{% endfor %}
		</div>
	</div>
	<div class="fixed-action-btn">
		<a class="btn-floating btn-large purple darken-1">
			<i class="large material-icons">mode_edit</i>
		</a>
		<ul>
			<li><a class="btn-floating red"><i class="material-icons">insert_chart</i></a></li>
			<li><a class="btn-floating yellow darken-1"><i class="material-icons">format_quote</i></a></li>
			<li><a class="btn-floating green"><i class="material-icons">publish</i></a></li>
			<li><a class="btn-floating blue"><i class="material-icons">attach_file</i></a></li>
		</ul>
	</div>	
</div>

<script type="text/javascript">
	$(function(){
		{% for item in web %}
		{% if item.featured %}
		var randomR = Math.floor((Math.random() * 130) + 100);
		var randomG = Math.floor((Math.random() * 130) + 100);
		var randomB = Math.floor((Math.random() * 130) + 100);
		var ctx = document.getElementById('{{item.title}}Chart').getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'line',
			data: {
				labels: [{% for obj in hist %}{% if item.title == obj.webtimer.title %}'{{obj.captured_date|date:"H:i"}}',{% endif %}{% endfor %}],
				datasets: [{
					label: '# Seconds',
					data: [{% for obj in hist %}{% if item.title == obj.webtimer.title %}'{{obj.loadtime}}',{% endif %}{% endfor %}],
					backgroundColor:"rgb(" 
            + (randomR - 80) + ", " 
            + (randomG - 80) + ", " 
            + (randomB - 80) + ", 0.4)",
				}]
			},
			options: {
				scales: {
					yAxes: [{
						ticks: {
							beginAtZero: true
						}
					}]
				}
			}
		});
		{% endif %}
		{% endfor %}
	});
</script>

{% endblock %}